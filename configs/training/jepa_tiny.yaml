# Tiny JEPA smoke-test configuration for local validation
seed: 7
dataset_manifest: data/tiny_manifest.jsonl

data:
  context_window: 3
  target_offset: 1
  shuffle: false

tokenizer:
  max_objects: 8
  max_color_features: 6
  background: 0
  connectivity: 4
  normalize: true
  respect_colors: true

object_encoder:
  hidden_dim: 64
  num_embeddings: 128
  commitment_cost: 0.25
  ema_decay: 0.99
  vq_refresh_enabled: false
  activation: "gelu"

optimizer:
  name: "adam"
  lr: 1.0e-3
  weight_decay: 0.0

training:
  batch_size: 2
  epochs: 1
  checkpoint_dir: artifacts/jepa/tiny_run
  device: cpu
  mixed_precision: "none"
  grad_accum_steps: 1
  grad_clip:
    max_norm: 1.0
    norm_type: 2.0
  lr_scheduler:
    name: "cosine"
    warmup_steps: 2
    min_lr_scale: 0.2

logging:
  enabled: true
  log_dir: artifacts/jepa/tiny_run/tensorboard
  flush_secs: 5

diagnostics:
  embedding_metrics:
    enabled: true
    interval: 1
    max_samples: 64

loss:
  objective: "infonce"
  temperature: 0.1
  temperature_min: 0.05
  temperature_max: 0.5
  learnable_temperature: true
  queue_size: 64
  projection_dim: 32
  projection_layers: 2
  projection_activation: "relu"

sigreg:
  weight: 0.0
  num_slices: 64
  num_points: 17
