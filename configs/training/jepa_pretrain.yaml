# JEPA pretraining configuration (placeholder values)
seed: 123
dataset_manifest: data/pilot_curriculum/manifest.jsonl

data:
  context_window: 3  # number of sequential grids per sample (k)
  target_offset: 1   # predict one step ahead

tokenizer:
  max_objects: 16
  max_color_features: 10
  background: 0
  connectivity: 4
  normalize: true
  respect_colors: true

object_encoder:
  hidden_dim: 256
  num_embeddings: 512
  commitment_cost: 0.25
  ema_decay: 0.99
  vq_refresh_enabled: true
  vq_refresh_interval: 50
  vq_refresh_usage_threshold: 0.01
  activation: "gelu"

model:
  type: "conv"
  embedding_dim: 512
  projection_dim: 256
  projection_layers: 2

optimizer:
  name: "adam"
  lr: 1.0e-4
  weight_decay: 1.0e-6

training:
  batch_size: 512
  epochs: 10
  checkpoint_dir: artifacts/jepa/pretrain
  device: cpu
  mixed_precision: "none"
  grad_accum_steps: 1
  grad_clip:
    max_norm: 1.0
    norm_type: 2.0
  lr_scheduler:
    name: "cosine"
    warmup_steps: 500
    min_lr_scale: 0.1

logging:
  enabled: true
  log_dir: artifacts/jepa/pretrain/tensorboard
  flush_secs: 15

diagnostics:
  embedding_metrics:
    enabled: true
    interval: 200
    max_samples: 4096

augmentations:
  mask_ratio: 0.2
  random_crop_radius: 1
  palette_permutation: true
  gaussian_noise_std: 0.05
  min_grid_size_for_crop: 8

loss:
  objective: "infonce"
  temperature_init: 0.07
  temperature_bounds: [0.03, 0.3]
  learnable_temperature: true
  queue_size: 4096
  projection_dim: 256
  projection_layers: 2
  projection_activation: "relu"

sigreg:
  weight: 0.0
  num_slices: 512
  num_points: 17
